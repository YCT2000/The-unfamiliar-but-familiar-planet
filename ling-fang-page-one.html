<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500&family=Open+Sans:wght@500&display=swap" rel="stylesheet">
    <link href="./css/styles.css" rel="stylesheet"> 
    <link href="./css/rwd.css" rel="stylesheet"> 
    <title>玲玲玲星球</title>
</head>
<body style="overflow: hidden;">

    <div class="loader-wrapper ">
        <img width="100%" src="./Video/LoadingMP4.gif"></img>
     </div>
     <div class="nav-div">
        <img src="./img/logo.png" class="nav__logo">
      
     
        <div class="navContainer hide" >
        <nav> 
            <ul class="navLinks ">
                <li id="base"><a href="">基地</a></li>
                <ul class="base__container">
                    <li><a href="branding.html">品牌介紹</a></li>
                    <li><a href="cooperative-association.html">合作協會</a></li>
                    <li><a href="app.html">應用程式</a></li>
                </ul>
                <li id="galaxy"><a href="main.html">行星</a></li>
           
                <li><a href="tower.html">塔台</a></li>
                <li><a href="explore.html">探索</a></li>
            </ul>

        </nav>
        </div>
        <button class="hamburger">
            <div class="burger"></div>
            <div class="burger"></div>
            <div class="burger"></div>
        </button>
    
        <button class="closeNav hide" >
            <div class="burger1"></div>
            <div class="burger2"></div>
            
        </button>
        
    </div>

    <div class="mobile__nav">
        <button class="hamburger-mobile">
            <div class="burger-mobile"></div>
            <div class="burger-mobile"></div>
            <div class="burger-mobile"></div>
        </button>
    


        <div class="navContainer_mobile" >
            <nav> 
                <ul class="navLinks_mobile hide">
                    <li id="base_mobile"><a href="">基地</a></li>
                    <ul class="base__container-mobile hide">
                        <li><a href="branding.html">品牌介紹</a></li>
                        <li><a href="cooperative-association.html">合作協會</a></li>
                        <li><a href="app.html">應用程式</a></li>
                    </ul>
                    <li id="galaxy_mobile"><a href="main.html">行星</a></li>
              
                    <li><a href="tower.html">塔台</a></li>
                    <li><a href="explore.html">探索</a></li>
                </ul>
    
            </nav>
            </div>
    </div>


    
    <div class="buttons">
        <a href="intro-ling-fang.html" title="pervious" class="pervious"><img src="./img/previous.png"></a>
        <a href="ling-fang-page-two.html" title="next" class="next"><img src="./img/next.png"></a>
    </div>
    <div class="dialogue hide" id="dialogue_pageone">
        <button class="dialogue___btns" id="next1">
            <img id="dialogue___btns-next" src="./img/dialogue_next.png">
        </button>
        <img src="./img/dialogue_cool.png" class="dialogue__img">
        <div class="content-box">
            <p id="content">0</p>
            <p id="content-second">0</p>
        </div>
    </div>
    <div class="dialogue hide" id="dialogue_pagetwo">
        <button class="dialogue___btns" id="next2">
            <img id="dialogue___btns-next" src="./img/dialogue_next.png">
        </button>
        <img src="./img/dialogue_cool.png" class="dialogue__img">
        <div class="content-box">
            <p id="content-third">0</p>
            <p id="content-fourth">0</p>
        </div>
    </div>
    <div class="dialogue hide" id="dialogue_pagethree">
        <button class="dialogue___btns" id="next3">
            <img id="dialogue___btns-next" src="./img/dialogue_next.png">
        </button>
        <img src="./img/dialogue_cool.png" class="dialogue__img">
        <div class="content-box">
            <p id="content-fifth">0</p>
            <p id="content-sixth">0</p>
        </div>
    </div>

    <div class="SparkleStar"><img src="./img/SparkleStar.png"></div>
    <div class="webgl-div">
    <canvas class="webgl"></canvas>
    </div> 
    <script src="https://cdn.jsdelivr.net/npm/three@0.122.0/build/three.min.js"></script>
    <script src="./extraScript/three_mmi.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://unpkg.com/browse/three@0.128.0/src/loaders/LoadingManager.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.122.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="./JavaEvent/nav.js"></script>

    <script>
        //Canvas
        const canvas = document.querySelector('.webgl')

        //Scene
        const scene = new THREE.Scene;
        scene.fog = THREE.Fog(0xffffff, 1, 2)

        const renderer = new THREE.WebGLRenderer({
            canvas,
            antialias: true,
            alpha: true,
        })
        const sizes = {
            width: window.innerWidth,
            height: window.innerHeight
        }

        //camera
        const camera = new THREE.PerspectiveCamera(45, sizes.width/ sizes.height, 1 ,1000)
        
        camera.rotation.y= 0
        function camera_ReSize() {
            if ($(window).width() < 768) {
                camera.position.z = 130
                camera.position.y = 60
                camera.position.x = -8
                camera.rotation.x= -0.4
            } else {
                camera.position.z = 40
        
            }}
        camera_ReSize()
        scene.add(camera)

        //renderer setting
        renderer.setSize(sizes.width, sizes.height)
        renderer.setPixelRatio(window.devicePixelRatio)
        renderer.shadowMap.type = THREE.PCFSoftShadowMap;
        document.body.appendChild(renderer.domElement)

        //Adding lights
        const spotLight = new THREE.SpotLight(0xe6bd85);
        spotLight.position.set( 20, 20, 30);

        spotLight.castShadow = true;
        spotLight.intensity = 0.4
        spotLight.shadow.mapSize.width = 1024;
        spotLight.shadow.mapSize.height = 1024;


        spotLight.shadow.camera.near = 500;
        spotLight.shadow.camera.far = 4000;
        spotLight.shadow.camera.fov = 30;

        scene.add( spotLight );
        const ambientLight = new THREE.AmbientLight(0xffffff);
        ambientLight.intensity = 0.9
        scene.add(ambientLight);

        const mmi = new MouseMeshInteraction(scene, camera)
        const clock = new THREE.Clock()
        let mixer

        let action
        let action2
        let action3
        let action4
        let action5
        let action6
        let action7
        const dialogue = document.querySelector('.dialogue')
        const buttons = document.querySelector('.buttons')
        const dialogueNext = document.getElementById('next1')
        const dialogueNext2 = document.getElementById('next2')
        const dialogueNext3 = document.getElementById('next3')
        const dialogue_page1 = document.getElementById('dialogue_pageone')
        const dialogue_page2 = document.getElementById('dialogue_pagetwo')
        const dialogue_page3 = document.getElementById('dialogue_pagethree')
        const content1 = document.getElementById('content')
        const content2 = document.getElementById('content-second')
        const content3 = document.getElementById('content-third')
        const content4 = document.getElementById('content-fourth')
        const content5 = document.getElementById('content-fifth')
        const content6 = document.getElementById('content-sixth')


        var manager = new THREE.LoadingManager(); 
manager.onStart = function ( url, itemsLoaded, itemsTotal ) { 
  console.log( 'Started loading file: ' + url + '.Loaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' ); 
}; 

manager.onLoad = function ( ) { 
  console.log( 'Loading complete!'); 
}; 

manager.onProgress = function ( url, itemsLoaded, itemsTotal ) { 
  console.log( 'Loading file: ' + url + '.Loaded ' + itemsLoaded + ' of ' + itemsTotal + ' files.' ); 
}; 

manager.onError = function ( url ) { 
  console.log( 'There was an error loading ' + url ); 
}; 

        //LingFang material
        const LingFangMap = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/LingFang_BaseColor.png')
        LingFangMap.flipY = false;
        LingFang_Mat = new THREE.MeshStandardMaterial({
            map : LingFangMap,
            skinning: true,
            roughness : 0.7,
        })
        const SceneMap = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/PlanetJ_BaseColor.png')
        SceneMap.flipY = false;
        Scene_Mat = new THREE.MeshStandardMaterial({
            map : SceneMap,
            roughness : 0.7,
        })
        const RoseMap = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/Rose_BaseColor.png')
        RoseMap.flipY = false;
        Rose_Mat = new THREE.MeshStandardMaterial({
            map : RoseMap,
            roughness : 0.7,
        })
        const AstronantMap = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/astronant_BaseColor.png')
        AstronantMap.flipY = false;
        Astounant_Mat = new THREE.MeshStandardMaterial({
            map : AstronantMap,
            skinning: true,
            roughness : 0.7,
        })
        const BaseColorMap = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/color.png')
        BaseColorMap.flipY = false;
        BaseColor_Mat = new THREE.MeshStandardMaterial({
            map : BaseColorMap,
            roughness : 0.7,
            side : THREE.DoubleSide,
        })
        const BaseColor2Map = new THREE.TextureLoader().load('./3Dmodels/PlanetJ_Ani/color2.png')
        BaseColor2Map.flipY = false;
        BaseColor2_Mat = new THREE.MeshStandardMaterial({
            map : BaseColor2Map,
            roughness : 0.7,
        })

      
        const StarMaterial = new THREE.MeshStandardMaterial({
            color: 0x3A8F96,
            roughness : 0.7,
            side : THREE.DoubleSide,
        })
        
    
        // loading the scene //
        const loadingManager = new THREE.LoadingManager

        loadingManager.onStart = function ( url, itemsLoaded, itemsTotal ) { 
        
        }; 
        loadingManager.onLoad = function () { 
         const Loader = document.querySelector('.loader-wrapper')
         const StartPage = document.querySelector('.startPage')

         function Loading(){
            Loader.classList.add('hide')
            StartPage.classList.remove('hide')
         }

         Loading()
        }; 

        //import Mesh
        const loader2 = new THREE.GLTFLoader(loadingManager)
        loader2.load('./3Dmodels/PlanetJ_Ani/planetScene1.gltf', function(gltf2){
            
         
         
        
            
            gltf2.scene.traverse(function(child){
                if(child.isMesh){
                    child.skinning = true
                }
                if(child.name == 'LingFang'){
                    child.material = LingFang_Mat 
                }
                if(child.name == 'LingFang2'){
                    child.material = LingFang_Mat 
                }
                if(child.name == 'LingFang3'){
                    child.material = LingFang_Mat 
                }
                if(child.name == 'LingFang4'){
                    child.material = LingFang_Mat 
                }
                if(child.name == 'Star'){
                    child.material = StarMaterial

                    mmi.addHandler('Star','mouseenter',function(){
                    if (child.name === 'Star') {
						child.material = BaseColor_Mat;
					}
                    })

                    mmi.addHandler('Star','mouseleave',function(){
                    if (child.name === 'Star') {
						child.material = StarMaterial;
					}
                    })

                }
                if(child.name == 'Star1'){
                    child.material = StarMaterial

                    mmi.addHandler('Star1','mouseenter',function(){
                    if (child.name === 'Star1') {
						child.material = BaseColor_Mat;
					}
                    })

                    mmi.addHandler('Star1','mouseleave',function(){
                    if (child.name === 'Star1') {
						child.material = StarMaterial;
					}
                    })

                }
                if(child.name == 'Star2'){
                    child.material = StarMaterial

                    mmi.addHandler('Star2','mouseenter',function(){
                    if (child.name === 'Star2') {
						child.material = BaseColor_Mat;
					}
                    })

                    mmi.addHandler('Star2','mouseleave',function(){
                    if (child.name === 'Star2') {
						child.material = StarMaterial;
					}
                    })

                }
                if(child.name == 'Star3'){
                    child.material = StarMaterial

                    mmi.addHandler('Star3','mouseenter',function(){
                    if (child.name === 'Star3') {
						child.material = BaseColor_Mat;
					}
                    })

                    mmi.addHandler('Star3','mouseleave',function(){
                    if (child.name === 'Star3') {
						child.material = StarMaterial;
					}
                    })

                }
                if(child.name == 'PlanetScene'){
                    child.material = Scene_Mat 
                }
                if(child.name == 'Plants'){
                    child.material = BaseColor_Mat 
                }
                if(child.name == 'basket'){
                    child.material = BaseColor_Mat 
                }
                if(child.name == 'plant'){
                    child.material = Rose_Mat 
                }
                if(child.name == 'leader'){
                    child.material = Astounant_Mat 
                }
                if(child.name == 'astronant'){
                    child.material = Astounant_Mat 
                }
                if(child.name == 'well'){
                    child.material = BaseColor_Mat 
                }
                if(child.name == 'flowers'){
                    child.material = BaseColor_Mat 
                }
                if(child.name == 'foods'){
                    child.material = BaseColor2_Mat 
                }
                if(child.name == 'tree'){
                    child.material = BaseColor2_Mat 
                }
                
                
                
                mixer = new THREE.AnimationMixer(gltf2.scene)
                action = mixer.clipAction(gltf2.animations[0])
                action2 = mixer.clipAction(gltf2.animations[1])
                /*action3 = mixer.clipAction(gltf2.animations[2])
                action4 = mixer.clipAction(gltf2.animations[3])
                action5 = mixer.clipAction(gltf2.animations[4])
                action6 = mixer.clipAction(gltf2.animations[5])
                action7 = mixer.clipAction(gltf2.animations[6])
                action8 = mixer.clipAction(gltf2.animations[7])
             
                action3.play()
                action4.play()
                action5.play()
                action6.play()
                action7.play()
                action8.play()*/
              
                action.play()
                action2.play()
                
               

                scene.add(gltf2.scene)

                mmi.addHandler('Star2','click',function(){
                camera.position.z = 15
                camera.position.y = -3
                camera.position.x=-22
                buttons.classList.add('hide')
                dialogue.classList.remove('hide')
                dialogue_page1.style.display = 'block'
                dialogue_page2.style.display = 'none'
                dialogue_page3.style.display = 'none'
                content1.innerHTML =  '花朵的花瓣都是一隻手比心心的形狀，' 
                content2.innerHTML = "看上去讓人心情很好，"
                content3.innerHTML =  '這裡的蘋果都是紅黑相間，' 
                content4.innerHTML = "而且有藍色的香菇。"
                })

              

                mmi.addHandler('Star','click',function(){
                camera.position.z = 25
                camera.position.x= 0
                camera.position.y=-4
                buttons.classList.add('hide')
                dialogue.classList.remove('hide')
                dialogue_page1.style.display = 'block'
                dialogue_page2.style.display = 'none'
                dialogue_page3.style.display = 'none'
                content1.innerHTML =  '這顆星球跟名字一樣，' 
                content2.innerHTML = "當太空人踏上這片土地的時候，"
                content3.innerHTML =  '每走一步都會發出微微的清脆鈴鐺聲音。' 
                content4.innerHTML = ""

                })

     

                mmi.addHandler('Star3','click',function(){
                camera.position.z = 10
                camera.position.x=-0
                camera.position.y= 5
                buttons.classList.add('hide')
                dialogue.classList.remove('hide')
                dialogue_page1.style.display = 'block'
                dialogue_page2.style.display = 'none'
                dialogue_page3.style.display = 'none'
                content1.innerHTML =  '似乎這顆星球沒有衛星，只有她一個人，' 
                content2.innerHTML = "所以她非常獨立，"
                content3.innerHTML =  '餓了會爬到樹上摘果實給自己吃，' 
                content4.innerHTML = "渴了會去井給自己打水喝。"
                
                })

            
                mmi.addHandler('Star1','click',function(){
                camera.position.z = 23
                camera.position.x= 16
                camera.position.y= -5
                buttons.classList.add('hide')
                dialogue.classList.remove('hide')
                dialogue_page1.style.display = 'block'
                dialogue_page2.style.display = 'none'
                dialogue_page3.style.display = 'none'
                content1.innerHTML =  '玲玲玲星球公主是一隻很愛笑的綿羊，' 
                content2.innerHTML = "她非常樂於助人和熱情。"
                content3.innerHTML =  '平常最喜歡做的就是收集漂亮的晶石樹葉等等，送給其他人，' 
                content4.innerHTML = "哪怕那個人不喜歡還是會塞給他。"
                })

           
            })
           
          

   

                dialogueNext.addEventListener('click', (event)=>{
                    dialogue_page1.style.display = 'none'
                    dialogue_page2.style.display = 'block'
                })
                dialogueNext2.addEventListener('click', (event)=>{
                    dialogue_page2.style.display = 'none'
                    dialogue_page3.style.display = 'none'
                    buttons.classList.remove('hide')
                    camera.position.z = 40
                    camera.position.x = 0
                    camera.position.y = 0
                })
              

        })
       
        //rendering progress
        function animate(){
            var delta = clock.getDelta()
            if(mixer)mixer.update(delta)

            requestAnimationFrame(animate)
            mmi.update()
            renderer.render(scene, camera)
        }
        animate()
  



    
    </script>
    <!--Kevin MacLeod的《Doh De Oh》，取得「Creative Commons 姓名標示 4.0」授權。 https://creativecommons.org/licenses/by/4.0/

來源： http://incompetech.com/music/royalty-free/index.html?isrc=USUAN1100255

歌手： http://incompetech.com/-->
    
</body>
</html>