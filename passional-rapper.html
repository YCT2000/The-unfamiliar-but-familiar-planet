<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500&family=Open+Sans:wght@500&display=swap" rel="stylesheet">
    <link href="./css/styles.css" rel="stylesheet"> 
    <link href="./css/rwd.css" rel="stylesheet"> 
    <title>熱情rapper系</title>
</head>
<body style="overflow: hidden;">


        
        <div id="startContainer" >

        <div id="ellipse">
            <img id='mascot_1' class="mascotAni" src="./img/mascot/mascot1.png">
        </div>

        <div class="mascotSpeech">
            <div class="mascotSpeech__div">
            <div class="dialogueMain">
                
                <p>偌大的宇宙裡有很多行星，你是否也發現自己身</p>
                <p >旁的那顆可愛的行星，不妨和我們一起走近他們...</p>
                
            </div>
            <div id="guideMainBTN" >GO</div>
            
        </div>
        <img id='mascot_bubble' src="./img/mascot/speechBubbling.png">
        </div>
      
        </div>
       
        
        
    </div>
</div >
      
    <div class="nav-div">
        <img src="./img/logo.png" class="nav__logo">
      
     
        <div class="navContainer hide" >
        <nav> 
            <ul class="navLinks ">
                <li id="base"><a href="">基地</a></li>
                <ul class="base__container">
                    <li><a href="branding.html">品牌介紹</a></li>
                    <li><a href="cooperative-association.html">合作協會</a></li>
                </ul>
                <li id="galaxy"><a href="main.html">行星</a></li>
                <ul class="galaxy__container">
                    <li><a href="">熱情rapper系</a></li>
                    <li><a href="">cool的酷系</a></li>
                </ul>
                <li><a href="tower.html">塔台</a></li>
                <li><a href="explore.html">探索</a></li>
            </ul>

        </nav>
        </div>
        <button class="hamburger">
            <div class="burger"></div>
            <div class="burger"></div>
            <div class="burger"></div>
        </button>
    
        <button class="closeNav hide" >
            <div class="burger1"></div>
            <div class="burger2"></div>
            
        </button>
        
    </div>

    

    <div class="SparkleStar"><img src="./img/SparkleStar.png" style=" width: 100%; position: fixed; top: 0; opacity: 0.7; animation: Sparkling 4s infinite;"></div>
    <div class="webgl-div">
    <canvas class="webgl"></canvas>
    </div>  
    <script src="https://cdn.jsdelivr.net/npm/three@0.122.0/build/three.min.js"></script>
    <script src="./extraScript/three_mmi.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.0/gsap.min.js"></script>
    <script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.122.0/examples/js/controls/OrbitControls.min.js"></script>
    <script src="./JavaEvent/nav.js"></script>
    <script src="./JavaEvent/mascotSpeech.js"></script>

<script>
      
const startMP = document.querySelector('#startMain')
const mascotMain = document.querySelector('#ellipse')
const mascotSpeechDiv = document.querySelector('.mascotSpeech')
const dialogueMain = document.querySelector('#dialogueMain')
const guideMainBTN = document.querySelector('#guideMainBTN')




guideMainBTN.addEventListener('click', ()=>{
    mascotMain.classList.add('mascot_bubbleFaded')
    mascotSpeechDiv.classList.add('mascot_bubbleFaded')
    startMP.style.opacity = ('0')

    
})

mascotMain.addEventListener('mouseover',()=>{
    mascotMain.style.cursor=('pointer')
})

mascotMain.addEventListener('click',()=>{

    mascotSpeechDiv.classList.remove('mascot_bubbleFaded')
    startMP.style.opacity = ('1')
   

})

//Canvas
const canvas = document.querySelector('.webgl')

//Scene
const scene = new THREE.Scene()
scene.fog = THREE.Fog(0xffffff, 1, 2)

const renderer = new THREE.WebGLRenderer({
    canvas,
    antialias: true,
    alpha: true,
})

const sizes={
    width: window.innerWidth,
    height: window.innerHeight
}


//camera
const camera = new THREE.PerspectiveCamera( 45, sizes.width/ sizes.height, 1, 1000)
scene.add(camera)
camera.position.z = 30

const cameraGroup = new THREE.Group()
cameraGroup.add(camera)
scene.add(cameraGroup)


//增加滾輪時差效果

const mouse = new THREE.Vector2()

window.addEventListener('mousemove', (event) =>{
    mouse.x = (event.clientX / sizes.width) * 2 - 1
    mouse.y = (event.clientY / sizes.height) * 2 - 1
})

window.addEventListener('touchmove', (event) => {
    const { clientX, clientY } = event.touches[0]
    mouse.x = (clientX / sizes.width) * 2 - 1
    mouse.y = -(clientY / sizes.height) * 2 + 1
  })


//renderer setting
renderer.setSize(window.innerWidth, window.innerHeight)
renderer.setPixelRatio(window.devicePixelRatio)
renderer.shadowMap.type = THREE.PCFSoftShadowMap;
document.body.appendChild(renderer.domElement)

//window resize handling
/*function onWindowResize(){
    
    camera.aspect = sizes.width / window.height
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2))
    camera.updateProjectionMatrix()
   
}
window.addEventListener('resize', onWindowResize)*/



//Fog

scene.fog = new THREE.Fog(0xfff1bd, 1, 50)
scene.fog.intensity = 0.02

//Adding lights
const spotLight = new THREE.SpotLight(0xe6bd85);
spotLight.position.set( 20, 20, 20);

spotLight.castShadow = true;
spotLight.intensity = 0.4
spotLight.shadow.mapSize.width = 1024;
spotLight.shadow.mapSize.height = 1024;


spotLight.shadow.camera.near = 500;
spotLight.shadow.camera.far = 4000;
spotLight.shadow.camera.fov = 30;

scene.add( spotLight );



const ambientLight = new THREE.AmbientLight(0xffffff);

scene.add(ambientLight);

const mmi = new MouseMeshInteraction(scene, camera)


//Material

//Planet A material
const PlanetAMap = new THREE.TextureLoader().load('./3Dmodels/texture/PlanetA_BaseColor.png')
PlanetAMap.flipY = false;
planetA_Mat = new THREE.MeshStandardMaterial({
    map : PlanetAMap,
    roughness : 0.7,
})



//Planet C material
const PlanetCMap = new THREE.TextureLoader().load('./3Dmodels/texture/PlanetC_BaseColor.png')
PlanetCMap.flipY = false;
planetC_Mat = new THREE.MeshStandardMaterial({
    map : PlanetCMap,
    roughness : 0.7,
})


//Planet F material
const PlanetFMap = new THREE.TextureLoader().load('./3Dmodels/texture/PlanetF_BaseColor.png')
PlanetFMap.flipY = false;
planetF_Mat = new THREE.MeshStandardMaterial({
    map : PlanetFMap,
    roughness : 0.7,
})



//Planet H material
const PlanetHMap = new THREE.TextureLoader().load('./3Dmodels/texture/PlanetH_BaseColor.png')
PlanetHMap.flipY = false;
planetH_Mat = new THREE.MeshStandardMaterial({
    map : PlanetHMap,
    roughness : 0.7,
})



//Planet J material
const PlanetJMap = new THREE.TextureLoader().load('./3Dmodels/texture/PlanetJ_BaseColor.png')
PlanetJMap.flipY = false;
planetJ_Mat = new THREE.MeshStandardMaterial({
    map : PlanetJMap,
    roughness : 0.7,
    side : THREE.DoubleSide,
})













//loading Models
//Character

//PlanetA
var loader1 = new THREE.GLTFLoader();
loader1.load('./3Dmodels/planetA.gltf', function ( gltf1 ) {
	
gltf1.scene.material = planetA_Mat
gltf1.scene.traverse(function (child) {


    if (child.isMesh) {
        child.name = 'planet_A'
        scene.add(gltf1.scene);
        child.material = planetA_Mat;
    }
  });
  /*gsap.to(gltf1.scene.rotation , {
    duration: 3,
    ease:Linear.easeNone,
    y: Math.PI * 2,
    x: Math.PI * 2,
    repeat: -1,
    //ease: "sine.inOut",
    
})*/
  mmi.addHandler('planet_A', 'click', function(){
    window.location.href = "intro-huai-ying.html"
    console.log("planet_A is Clicked")
    })

    mmi.addHandler('planet_A', 'mouseenter', function(){

        gsap.to(gltf1.scene.rotation , {
            duration: 1.5,
            ease: 'power2.inOut',
            x: '+=6',
            y:'+=3',
            z:'+=3'
        })
    
        
        console.log("on planet_A")
    })


    mmi.addHandler('planet_A', 'mouseleave', function(){
    
        console.log("out of planet_A")
      
    })



function planetA_ReSize() {
    if ($(window).width() < 768) {
        gltf1.scene.scale.set(0.5,0.5,0.5)
        gltf1.scene.position.set(3, -3, 3)
     
        
    } else {
        gltf1.scene.scale.set(1,1,1)
        gltf1.scene.position.z = 20
        gltf1.scene.position.x = 4
        gltf1.scene.position.y = -2
    
       
    }
};
planetA_ReSize();
});




//PlanetC Import
var loader3 = new THREE.GLTFLoader();
loader3.load('./3Dmodels/planetC.gltf', function ( gltf3 ) {
	

gltf3.scene.traverse(function (child) {


if (child.isMesh) {
    child.name = 'planet_C'
    child.material = planetC_Mat 
    scene.add(gltf3.scene);
}
});

mmi.addHandler('planet_C', 'click', function(){
    window.location.href = "yu-lian-page-one.html"
    console.log("planet_C is Clicked")
})

mmi.addHandler('planet_C', 'mouseenter', function(){

    gsap.to(gltf3.scene.rotation , {
        duration: 1.5,
        ease: 'power2.inOut',
        x: '+=6',
        y:'+=3',
        z:'+=3'
       })
        
    console.log("on planet_C")
    })


mmi.addHandler('planet_C', 'mouseleave', function(){
    
    console.log("out of planet_C")
   })



function planetC_ReSize() {
    if ($(window).width() < 768) {
        gltf3.scene.scale.set(0.5,0.5,0.5)
        gltf3.scene.position.set(-2, 3, 9 )

    } else {
        gltf3.scene.scale.set(1,1,1)
        gltf3.scene.position.z = 15
        gltf3.scene.position.x = -4
        gltf3.scene.position.y = 2
    }
};
planetC_ReSize();

});




//PlanetF Import
var loader6 = new THREE.GLTFLoader();
loader6.load('./3Dmodels/planetF.gltf', function ( gltf6 ) {
	
gltf6.scene.traverse(function (child) {


if (child.isMesh) {
    child.material = planetF_Mat;
    child.name = 'planet_F'
    scene.add(gltf6.scene);
}
});

mmi.addHandler('planet_F', 'click', function(){
    window.location.href = "shao-mei-page-one.html"
    console.log("planet_F is Clicked")
})

mmi.addHandler('planet_F', 'mouseenter', function(){

    gsap.to(gltf6.scene.rotation , {
        duration: 1.5,
        ease: 'power2.inOut',
        x: '+=6',
        y:'+=3',
        z:'+=3'
       })
        
    console.log("on planet_F")
    })


mmi.addHandler('planet_F', 'mouseleave', function(){
    
    console.log("out of planet_F")
   })



function planetF_ReSize() {
    if ($(window).width() < 768) {
        gltf6.scene.scale.set(0.6,0.6,0.6)
        gltf6.scene.position.set(0,0,0)
    } else {
        gltf6.scene.scale.set(1,1,1)
        gltf6.scene.position.z = 5
        gltf6.scene.position.x = 0
        gltf6.scene.position.y = 1    
    
    }
};
planetF_ReSize();
});






//PlanetH Import
var loader8 = new THREE.GLTFLoader();
loader8.load('./3Dmodels/planetH.gltf', function ( gltf8 ) {
	
gltf8.scene.traverse(function (child) {


if (child.isMesh) {
    child.material = planetH_Mat;
    child.name = 'planet_H'
    scene.add(gltf8.scene);
}
});

mmi.addHandler('planet_H', 'click', function(){
    window.location.href = "intro-lin-chun.html"
    console.log("planet_H is Clicked")
})

mmi.addHandler('planet_H', 'mouseenter', function(){

    gsap.to(gltf8.scene.rotation , {
        duration: 1.5,
        ease: 'power2.inOut',
        x: '+=6',
        y:'+=3',
        z:'+=3'
       })
        
    console.log("on planet_H")
    })


mmi.addHandler('planet_H', 'mouseleave', function(){
    
    console.log("out of planet_H")
   })



function planetH_ReSize() {
    if ($(window).width() < 768) {
        gltf8.scene.scale.set(0.5,0.5,0.5)
        gltf8.scene.position.set(2,-6,3)
    } else {
        gltf8.scene.scale.set(1,1,1)
        gltf8.scene.position.z = 4
        gltf8.scene.position.x = -12
        gltf8.scene.position.y = 6
    }
};
planetH_ReSize();

});




//PlanetJ Import
var loader10 = new THREE.GLTFLoader();
loader10.load('./3Dmodels/planetJ.gltf', function ( gltf10 ) {
	

gltf10.scene.traverse(function (child) {


if (child.isMesh) {
    child.material = planetJ_Mat;
    child.name = 'planet_J'
    scene.add(gltf10.scene);
}
});

mmi.addHandler('planet_J', 'click', function(){
    window.location.href = "intro-ling-fang.html"
    console.log("planet_J is Clicked")
})

mmi.addHandler('planet_J', 'mouseenter', function(){

    gsap.to(gltf10.scene.rotation , {
        duration: 1.5,
        ease: 'power2.inOut',
        x: '+=6',
        y:'+=3',
        z:'+=3'
       })
        
    console.log("on planet_J")
    })


mmi.addHandler('planet_J', 'mouseleave', function(){
    
    console.log("out of planet_J")
   })



function planetJ_ReSize() {
    if ($(window).width() < 768) {
        gltf10.scene.scale.set(0.7,0.7,0.7)
        gltf10.scene.position.set(0,6,0.5)
        
    } else {
        gltf10.scene.scale.set(1,1,1)
        gltf10.scene.position.z = 17
        gltf10.scene.position.x = 4
        gltf10.scene.position.y = 3   
    
    }
};
planetJ_ReSize();

});


//rendering progress
function animate(){

   const objectDistance = 8
    camera.position.setY((-scrollY / sizes.height) * objectDistance)
    if(mouse.x && mouse.y){
        cameraGroup.position.setX(mouse.x)
        cameraGroup.position.setY(mouse.y)
    }
   
   

    requestAnimationFrame(animate)
    mmi.update()
    renderer.render(scene, camera)

}
animate()
    </script>
</body>
</html>